Texas Instruments, Inc.

Z-Stack Home Release Notes

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------

Version 1.2.1
August 05, 2014


Notices:
 - Z-Stack Home 1.2.1 meets requirements for full conformance to the ZigBee
   Home Automation 1.2 specification. The Z-Stack Home 1.2.1 release is based
   on the certified Z-Stack Core 2.6.2. See the "Z-Stack Core Release Notes"
   for details.

 - Z-Stack Home provides over 20 documents that cover various aspects of this
   Home Automation development package. Included is API documentation for each
   layer of the Z-Stack system, and a selection of Developer's Guides, User's
   Guides, and Application Notes to accelerate your product development. These
   documents can be found at: <InstallPath>\Documents with the default set to:
   "C:\Texas Instruments\Z-Stack Home 1.2.1\Documents" which can be accessed
   from the Windows Start Menu.

 - Z-Stack for the CC2530 platform has been built and tested with IAR's CLIB
   library, which provides a light-weight C library which does not support
   Embedded C++. Use of DLIB is not recommended for this platform. Z-Stack
   for the CC2538 platform has been tested with the DLIB library.

 - Z-Stack projects specify compile options in two ways: (1) "-D" statements
   in f8wConfig.cfg and other *.cfg files, (2) entries in the IDE Compiler
   Preprocessor Defined Symbols. When using the EW8051 or EW430 compilers,
   settings made in the IDE will override settings in the *.cfg files. When
   using the EWARM compiler, settings in the *.cfg files will override any
   made in the IDE.

 - When programming devices for the first time with this release, the entire
   Flash memory should be erased. For the CC2530 and EXP5438 platforms, select
   "Erase Flash" in the "Debugger->Texas Instruments->Download" tab of the
   project options. For the CC2538, select "Project->Download->Erase Memory".

 - Library and hex files were built and tested with the following versions of
   IAR tools and may not work with different versions of the IAR tools:
     - CC2538 + SRF06EB:  EWARM 7.20.1  (7.20.1.7307)
     - CC2530 + SRF05EB:  EW8051 8.30.3 (8.30.3.41795)
     - CC2530 + EXP5438:  EW430 6.10.2  (6.10.2.50871)

 - Foundation software library files for the CC2538 include the following:
     - bsp.lib, version 1.3.1
     - driverlib.lib, version 1.3.1
     - usblib.lib, version 1.0.1


Changes:
 - [5732] Added all Home Automation Device IDs (zcl_ha.h) that are defined in
   Table 5.1 of "docs-05-3520-29-00ha-home-automation-profile-specification".

 - [5679] Modified the SampleLight sample applications to support PWM-based LED
   level control. For the CC2530, a new configuration (RouterZLight) is added
   that is used in conjunction with TI's ZLight2 device. Refer to the "Z-Stack
   Home Developer's Guide" and "Z-Stack Home Sample Application User's Guide"
   documents for details.

 - [5666] Changed compiler optimization settings for CC2538-based IAR projects
   from "None" to "High, Balanced".

 - [5613] Added new Security and Safety received/generated command values for
   the IAS ACE cluster {Errata section 1.1.4 CCB 1781}:
      > COMMAND_SS_IAS_ACE_GET_PANEL_STATUS
      > COMMAND_SS_IAS_ACE_GET_ZONE_STATUS
      > COMMAND_SS_IAS_ACE_ZONE_STATUS_CHANGED
      > COMMAND_SS_IAS_ACE_PANEL_STATUS_CHANGED
      > COMMAND_SS_IAS_ACE_GET_PANEL_STATUS_RESPONSE
      > COMMAND_SS_IAS_ACE_GET_ZONE_STATUS_RESPONSE
 
 - [5523] Added a new Basic Device Information attribute and an associated list
   of Application Profile Type Attributes {Errata section 1.1.33 CCB 1873}:
      > ATTRID_BASIC_APPLICATION_PROFILE_VERSION
      > APPLICATION_PROFILE_TYPE_ZIGBEE_BUILDING_AUTOMATION
      > APPLICATION_PROFILE_TYPE_ZIGBEE_REMOTE_CONTROL
      > APPLICATION_PROFILE_TYPE_ZIGBEE_SMART_ENERGY
      > APPLICATION_PROFILE_TYPE_ZIGBEE_HEALTH_CARE
      > APPLICATION_PROFILE_TYPE_ZIGBEE_HOME_AUTOMATION
      > APPLICATION_PROFILE_TYPE_ZIGBEE_INPUT_DEVICE
      > APPLICATION_PROFILE_TYPE_ZIGBEE_LIGHT_LINK
      > APPLICATION_PROFILE_TYPE_ZIGBEE_RETAIL_SERVICES
      > APPLICATION_PROFILE_TYPE_ZIGBEE_TELECOM_SERVICES

 - [5521] Added new General ZCL attribute values for the Level Control cluster.
   Updated zclGeneral_ProcessInLevelControl() to validate incoming level against
   MIN_LEVEL and MAX_LEVEL attributes. {Errata section 1.1.33 CCB 1873}:
      > ATTR_LEVEL_MIN_LEVEL
      > ATTR_LEVEL_MID_LEVEL
      > ATTR_LEVEL_MAX_LEVEL
      > ATTR_LEVEL_ON_LEVEL_NO_EFFECT

 - [5520] Added new Security and Safety attribute and command values for IAS
   Zone cluster {Errata section 1.1.29 CCB 1861}:
      > ATTRID_SS_NUM_ZONE_SENSITIVITY_LEVELS_SUPPORTED
      > ATTRID_SS_CURRENT_ZONE_SENSITIVITY_LEVEL
      > COMMAND_SS_IAS_ZONE_STATUS_INIT_NORMAL_OP_MODE
      > COMMAND_SS_IAS_ZONE_STATUS_INIT_TEST_MODE

 - [5519] Added new Security and Safety received/generated command values for
   the IAS ACE cluster {Errata section 1.1.27 CCB 1855}:
      > COMMAND_SS_IAS_ACE_GET_BYPASSED_ZONE_LIST
      > COMMAND_SS_IAS_ACE_SET_BYPASSED_ZONE_LIST
      > COMMAND_SS_IAS_ACE_BYPASS_RESPONSE

 - [5508] Added new Security and Safety enumeration values for IAS WD cluster
   WarningMode attributes {Errata section 1.1.13 CCB 1810}:
      > SS_IAS_START_WARNING_WARNING_MODE_POLICE_PANIC
      > SS_IAS_START_WARNING_WARNING_MODE_FIRE_PANIC
      > SS_IAS_START_WARNING_WARNING_MODE_EMERGENCY_PANIC

 - [5488] Changed the default values of Alarm and Event Masks Attribute Set from
   0xFF to 0x0000. {Errata section 1.1.14 CCB 1811}

 - [5487] Added new Security and Safety attribute values for IAS Zone cluster
   ZoneType attributes {Errata section 1.1.13 CCB 1810}:
      > SS_IAS_ZONE_TYPE_GLASS_BREAK_SENSOR
      > SS_IAS_ZONE_TYPE_SECURITY_REPEATER

 - [5486] Updated the Power Configuration cluster to include enumeration values
   for Battery Alarm State Attribute bits, including the new value of 0x40000000
   for BAT_ALARM_STATE_MAINS_POWER_SUPP_LOST. {Errata section 1.1.12 CCB 1809}

 - [5431] Changed the way that Sample Applications demonstrate the OTA feature.
   The old SampleSwitchOTA projects have been removed, and new configurations
   have been added to the SampleSwitch projects that provide OTA functionality.
   See the "Z-Stack OTA Upgrade User's Guide" and the "Z-Stack Home Developer's
   Guide" for details.


Bug Fixes:
 - [5741] Added ZCL_CLUSTER_ID_GEN_IDENTIFY to zclSampleSw_OutClusterList[]
   for the Sample Switch application, so that the ON/OFF switch now supports
   the Identify cluster.
   
 - [5707] Fixed a problem in the OTA Client (see zclOTA_event_loop()), where
   the device would incorrectly query the OTA Server for a new image during
   an active OTA transfer.

 - [5646] Fixed Sample Applications to disable NWK Multicast, per section 5.2.3
   of "docs-05-3520-29-00ha-home-automation-profile-specification", by adding
   MULTICAST_ENABLED=FALSE to pre-processor definitions for all project files.
   The nwk_globals.c and nwk_globals.h files were updated to initialize the NIB
   using the new compile flag.

 - [5584] Modified zclGeneral_ProcessInGroupsServer() to remove all Scenes that
   are associated with Group that is being removed.

 - [5564] Corrected a data type declaration error in Sample Application data
   files (example: zcl_samplesw_data.c), where the ZCL_CLUSTER_ID_GEN_ON_OFF
   attribute should be ZCL_DATATYPE_BOOLEAN instead of ZCL_DATATYPE_UINT8.

 - [5500] Fixed a problem in zclParseInDiscCmdsRspCmd() that calculated the
   wrong size for a dynamic buffer allocation.

 - [5499] Fixed a problem in zclParseInDiscAttrsExtRspCmd() that calculated the
   wrong size for a dynamic buffer allocation.

 - [5388] Fixed an issue in zclSampleDoorLock_DoorLockCB() that caused redundant
   default responses to be sent.

 - [5387] Fixed an issue in zcl_EZModeAction() that caused incorrect handling of
   a received Match Descriptor response, resulting in unwanted device bindings.


Memory Sizes:
 - Actual usage of Flash and RAM memory is variable, of course, and dependent
   on the specific application. Developers should adjust various parameters,
   such as, program stack size and dynamic memory heap size to meet their
   specific needs.

 - The following tables provide comparison of Flash and RAM sizes for certain
   device configurations for the HomeAutomation SampleLight application provided
   with this release. These SampleLight projects can be found in the installed
   ..\Projects\zstack\HomeAutomation\SampleLight folder for various HW platforms.
   In most Z-Stack sample applications, generic heap and stack settings are used
   which have been selected to accommodate a wide range of applications. For the
   HA SampleLight, heap settings were: for CC2538, all configurations = 6Kb; for
   CC2530, Coordinator/Router = 3Kb, EndDevice = 2Kb. See "Z-Stack Developer's
   Guide" document for details on profiling heap memory usage.

 - Memory sizes (Flash/RAM) are shown below for the 3 ZigBee device types on
   various MCU and RF platforms with ZigBee-PRO enabled and Security enabled.
   See the "Z-Stack User's Guide" for more details on the platform of interest.

   CC2530EM on SmarfRF05EB
   =======================
   Coordinator  198.4K / 7.3K
   Router       199.2K / 7.3K
   End-Device   165.0K / 5.7K

   CC2538EM on SmarfRF06EB
   =======================
   Coordinator  117.7K / 13.5K
   Router       118.6K / 13.5K
   End-Device    95.2K / 12.7K


Known Issues:
 - The ZAP sample applications retain the older format (from the Home-1.1.0
   release), so they do not provide EZ-Mode commissioning.

 - To disable security at build time, use the "SECURE=0" compile option. Do
   not attempt to disable security by setting the SECURITY_LEVEL to zero.

 - The ZDO Complex Descriptor is not supported.

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
